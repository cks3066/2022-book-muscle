# let, const 키워드와 블록 레벨 스코프

## var 키워드로 선언한 변수의 문제점

다음은 문제점 세 가지다.

- 변수 중복 선언 허용
  - var 키워드로 선언한 변수는 중복 선언이 가능하다.
- 함수 레벨 스코프
  - var 키워드로 선언한 변수는 오로지 함수의 코드 블록만을 지역 스코프로 인정한다.
    - 따라서 `함수의 코드블록`이 아닌 `그 외 코드 블록(if, for, while, try/catch 등)` 내에서 선언된 var 키워드 변수는 `전역 변수`가 된다.
- 변수 호이스팅
  - var 변수는 런타임 이전에 `선언 단계`(스코프에 변수 식별자 등록)와 `초기화 단계`(undefined로 변수 초기화)가 한번에 진행된다. 따라서 변수 선언문 이전에 변수에 접근해도 에러가 발생하지 않고 undefined를 반환한다.
    - 이처럼 에러를 발생시키지는 않지만, 프로그램의 흐름상 맞지 않고 가독성도 떨어지며 오류가 발생할 여지가 있다.

## let 키워드

- 변수 중복 선언 금지
- 블록 레벨 스코프
  - let 키워드로 선언한 변수는 `모든 코드 블록(함수, if, for, while, try/catch 등)`을 지역 스코프로 인정하는 블록 레벨 스코프를 따른다.
- 변수 호이스팅

  - let 변수는 `선언 단계`(스코프에 변수 식별자 등록)와 `초기화 단계`(변수 선언문에 도달했을 때 실행됨)가 분리되어 진행되므로, let 변수를 변수 선언문 이전에 참조하면 참조 에러가 발생한다.
    - 즉, 스코프 시작 지점부터 초기화 시작 지점까지 변수를 참조할 수 없는 구간을 `일시적 사각지대(TDZ)`라 부른다.
    - 변수 호이스팅은 발생한다. 다만, 선언만 호이스팅되고, 초기화는 호이스팅되지 않는다. 이 때문에 let(const, class도 마찬가지)을 사용한 선언문은 호이스팅이 발생하지 않는 것처럼 동작할 뿐이다.
      - 참고로 JS는 모든 선언(var, elt, const, function, function\*, class 등)을 호이스팅한다.

- 전역 객체와 let
  - let 키워드로 선언한 전역 변수는 (var와 달리) 전역 객체의 프로퍼티가 아니다. 즉, window.변수명 으로 접근할 수 없다.
    - 대신, let 전역 변수는 `보이지 않는 개념적인 블록`내에 존재한다.

## const 키워드

const는 let과 대부분 동일하지만, 특징은 다음과 같다.

- 선언과 초기화
  - const키워드로 선언한 변수는 반드시 선언과 동시에 초기화해야 한다.
- 재할당 금지
- 상수
  - 스네이크 케이스 사용 (`TAX_RATE`)

## 결론

- var 키워드 사용하지 말자
- 일단 변수 선언 시 기본으로 const 키워드를 사용한다.
- 재할당이 필요한 경우에 한정해 let 키워드를 사용하다. 변수의 스코프는 최대한 좁게 만든다.
